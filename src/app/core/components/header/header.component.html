<nav class="nav__container" [class.open]="menuOpen">
  <div class="nav-mobile__container" [class.open]="menuOpen">
    <ng-container [ngTemplateOutlet]="logoNavItem" />
    <div class="nav__item">
      <sl-button class="button--icon nav__hamburger" (click)="toggleMenu()">
        <sl-icon name="list" />
      </sl-button>
    </div>
  </div>
  <div class="nav__items" [class.open]="menuOpen">
    @if (!menuOpen) {
      <ng-container [ngTemplateOutlet]="logoNavItem" />
    }
    @for (item of navItems; track item.id) {
      @if (
        (item.isUserRequired && isUserLoggedIn) ||
        (!item.isUserRequired && !isUserLoggedIn) ||
        item.isUserRequired === undefined
      ) {
        <div class="nav__item" [class.user-logged]="isUserLoggedIn">
          @switch (item.type) {
            @case (navItemType.LINK) {
              <a
                class="nav__link"
                routerLinkActive="active"
                ariaCurrentWhenActive="page"
                i18n-ariaCurrentWhenActive
                [routerLinkActiveOptions]="{ exact: true }"
                [routerLink]="item.url"
                (click)="closeMenu()"
              >
                {{ item.text | firstTitleCase }}
              </a>
            }
            @case (navItemType.INPUT) {
              <app-pokemon-search
                (loading)="pokemonLoading = $event"
                (pokemonLoaded)="item.change && item.change($event)"
              />
              @if (pokemonLoaded?.sprites?.front_default) {
                <a [routerLink]="pokemonLoadedRoute">
                  <img
                    class="pokemon-search__image"
                    alt="pokemon image"
                    i18n-alt
                    width="40"
                    height="40"
                    priority
                    [ngSrc]="pokemonLoaded?.sprites?.front_default || ''"
                  />
                </a>
              }
              @if (pokemonLoading) {
                <div class="loading__circle"></div>
              }
            }
            @case (navItemType.BUTTON) {
              <sl-button
                class="button--primary"
                size="medium"
                i18n-size
                pill
                (click)="item.click && item.click()"
                >{{ item.text | firstTitleCase }}
                <sl-icon slot="suffix" i18n-slot name="box-arrow-right" />
              </sl-button>
            }
          }
        </div>
      }
    }

    @if (!isUserLoggedIn) {
      <div class="nav__item">
        <app-language-selector />
      </div>

      <div class="nav__item">
        <sl-button class="button--icon" (click)="toggleTheme()">
          @if (themeSelected === Theme.DARK || !themeSelected) {
            <sl-icon name="brightness-high-fill" />
          } @else {
            <sl-icon name="moon" />
          }
        </sl-button>
      </div>
    }
  </div>
</nav>

<ng-template #logoNavItem>
  <div class="nav__item">
    <a class="nav__link" [routerLink]="ROOT_URLS.home">
      <img
        alt="angular logo"
        i18n-alt
        ngSrc="/assets/icons/favicon-48x48.png"
        i18n-ngSrc
        width="48"
        height="48"
        priority
      />
    </a>
  </div>
</ng-template>
